
  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    

<!Doctype html>
<html id="docs" class="Concepts">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
    <link rel="stylesheet" type="text/css" href="/css/styles.css"><!-- default styles.css on -->
    <link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
    <link rel="stylesheet" type="text/css" href="/css/callouts.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/tags.css">
    
    
    <!-- no custom css detected -->

    
    <meta name="description" content="镜像" />
    

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/custom-jekyll/tags.js"></script>
    <!-- no custom js detected -->
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>镜像 | Kubernetes</title>
<meta name="generator" content="Jekyll v3.6.0" />
<meta property="og:title" content="镜像" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Production-Grade Container Orchestration" />
<meta property="og:description" content="Production-Grade Container Orchestration" />
<link rel="canonical" href="http://0.0.0.0:4000/docs/concepts/containers/images/" />
<meta property="og:url" content="http://0.0.0.0:4000/docs/concepts/containers/images/" />
<meta property="og:site_name" content="Kubernetes" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@kubernetesio" />
<script type="application/ld+json">
{"description":"Production-Grade Container Orchestration","@type":"WebPage","url":"http://0.0.0.0:4000/docs/concepts/containers/images/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4000/images/favicon.png"}},"headline":"镜像","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            <li><a href="/docs/home/">Documentation</a></li>
            <li><a href="http://blog.kubernetes.io/">Blog</a></li>
            <li><a href="/partners/">Partners</a></li>
            <li><a href="/community/">Community</a></li>
            <li><a href="/case-studies/">Case Studies</a></li>
            <li>
                <a href="#">
                    v1.9 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    
                    <li><a href="https://kubernetes.io/docs/concepts/containers/images/">v1.9</a></li>
                    
                
                    
                    <li><a href="https://v1-8.docs.kubernetes.io/docs/concepts/containers/images/">v1.8</a></li>
                    
                
                    
                    <li><a href="https://v1-7.docs.kubernetes.io/docs/concepts/containers/images/">v1.7</a></li>
                    
                
                    
                    <li><a href="https://v1-6.docs.kubernetes.io/docs/concepts/containers/images/">v1.6</a></li>
                    
                
                    
                    <li><a href="https://v1-5.docs.kubernetes.io/docs/concepts/containers/images/">v1.5</a></li>
                    
                
                </ul>
            </li>
        </ul>
        <!-- <a href="/docs/home" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a> -->
        <a href="/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/home/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community/">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        <div class="nav-box">
            <h3><a href="http://blog.kubernetes.io">Blog</a></h3>
            <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Concepts</h1>
  <h5>Detailed explanations of Kubernetes system concepts and abstractions.</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/home/" >HOME</a></li>
      <li><a href="/docs/setup/" >SETUP</a></li>
      <li><a href="/docs/concepts/" class="YAH">CONCEPTS</a></li>
      <li><a href="/docs/tasks/" >TASKS</a></li>
      <li><a href="/docs/tutorials/" >TUTORIALS</a></li>
      <li><a href="/docs/reference/" >REFERENCE</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)" autofocus="autofocus">
    </div>
  </div>
</section>




<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
          
  

    

    
      <a class="item" data-title="概念" href="/docs/concepts/"></a>
    
  

  
    <div class="item" data-title="Overview">
      <div class="container">
        
  

    

    
      <a class="item" data-title="认识 Kubernetes?" href="/docs/concepts/overview/what-is-kubernetes/"></a>
    
  

  

    

    
      <a class="item" data-title="Kubernetes 组件" href="/docs/concepts/overview/components/"></a>
    
  

  

    

    
      <a class="item" data-title="Kubernetes API" href="/docs/concepts/overview/kubernetes-api/"></a>
    
  

  
    <div class="item" data-title="Working with Kubernetes Objects">
      <div class="container">
        
  

    

    
      <a class="item" data-title="理解 Kubernetes 对象" href="/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>
    
  

  

    

    
      <a class="item" data-title="Names" href="/docs/concepts/overview/working-with-objects/names/"></a>
    
  

  

    

    
      <a class="item" data-title="Namespaces" href="/docs/concepts/overview/working-with-objects/namespaces/"></a>
    
  

  

    

    
      <a class="item" data-title="Labels 和 Selectors" href="/docs/concepts/overview/working-with-objects/labels/"></a>
    
  

  

    

    
      <a class="item" data-title="Annotations" href="/docs/concepts/overview/working-with-objects/annotations/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Object Management Using kubectl">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Kubernetes 对象管理" href="/docs/concepts/overview/object-management-kubectl/overview/"></a>
    
  

  

    

    
      <a class="item" data-title="使用命令式命令管理 Kubernetes 对象" href="/docs/concepts/overview/object-management-kubectl/imperative-command/"></a>
    
  

  

    

    
      <a class="item" data-title="使用配置文件对 Kubernetes 对象的命令式管理" href="/docs/concepts/overview/object-management-kubectl/imperative-config/"></a>
    
  

  

    

    
      <a class="item" data-title="Declarative Management of Kubernetes Objects Using Configuration Files" href="/docs/concepts/overview/object-management-kubectl/declarative-config/"></a>
    
  


      </div>
    </div>
  


      </div>
    </div>
  

  
    <div class="item" data-title="Kubernetes Architecture">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Nodes" href="/docs/concepts/architecture/nodes/"></a>
    
  

  

    

    
      <a class="item" data-title="Master 节点通信" href="/docs/concepts/architecture/master-node-communication/"></a>
    
  

  

    

    
      <a class="item" data-title="云控制器管理器的基础概念" href="/docs/concepts/architecture/cloud-controller/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Extending Kubernetes">
      <div class="container">
        
  

    

    
      <a class="item" data-title="扩展 Kubernetes 集群" href="/docs/concepts/overview/extending/"></a>
    
  

  
    <div class="item" data-title="Extending the Kubernetes API">
      <div class="container">
        
  

    

    
      <a class="item" data-title="使用聚合层扩展Kubernetes API" href="/docs/concepts/api-extension/apiserver-aggregation/"></a>
    
  

  

    

    
      <a class="item" data-title="自定义资源" href="/docs/concepts/api-extension/custom-resources/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Compute, Storage, and Networking Extensions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="网络插件" href="/docs/concepts/cluster-administration/network-plugins/"></a>
    
  

  

    

    
      <a class="item" data-title="设备插件" href="/docs/concepts/cluster-administration/device-plugins/"></a>
    
  

  

    

    
      <a class="item" data-title="在 Kubernetes 集群中使用 Sysctl" href="/docs/concepts/cluster-administration/sysctl-cluster/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="服务目录" href="/docs/concepts/service-catalog/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Containers">
      <div class="container">
        
  

    

    
      <a class="item" data-title="镜像" href="/docs/concepts/containers/images/"></a>
    
  

  

    

    
      <a class="item" data-title="容器环境变量" href="/docs/concepts/containers/container-environment-variables/"></a>
    
  

  

    

    
      <a class="item" data-title="容器生命周期的钩子" href="/docs/concepts/containers/container-lifecycle-hooks/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Workloads">
      <div class="container">
        
  
    <div class="item" data-title="Pods">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Pod Overview" href="/docs/concepts/workloads/pods/pod-overview/"></a>
    
  

  

    

    
      <a class="item" data-title="Pods" href="/docs/concepts/workloads/pods/pod/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod 生命周期" href="/docs/concepts/workloads/pods/pod-lifecycle/"></a>
    
  

  

    

    
      <a class="item" data-title="Init 容器" href="/docs/concepts/workloads/pods/init-containers/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod Preset" href="/docs/concepts/workloads/pods/podpreset/"></a>
    
  

  

    

    
      <a class="item" data-title="Disruption(中断)" href="/docs/concepts/workloads/pods/disruptions/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Controllers">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Replica Sets" href="/docs/concepts/workloads/controllers/replicaset/"></a>
    
  

  

    

    
      <a class="item" data-title="Replication Controller" href="/docs/concepts/workloads/controllers/replicationcontroller/"></a>
    
  

  

    

    
      <a class="item" data-title="Deployment" href="/docs/concepts/workloads/controllers/deployment/"></a>
    
  

  

    

    
      <a class="item" data-title="StatefulSet" href="/docs/concepts/workloads/controllers/statefulset/"></a>
    
  

  

    

    
      <a class="item" data-title="Daemon Sets" href="/docs/concepts/workloads/controllers/daemonset/"></a>
    
  

  

    

    
      <a class="item" data-title="垃圾收集" href="/docs/concepts/workloads/controllers/garbage-collection/"></a>
    
  

  

    

    
      <a class="item" data-title="Jobs - Run to Completion" href="/docs/concepts/workloads/controllers/jobs-run-to-completion/"></a>
    
  

  

    

    
      <a class="item" data-title="Cron Job" href="/docs/concepts/workloads/controllers/cron-jobs/"></a>
    
  


      </div>
    </div>
  


      </div>
    </div>
  

  
    <div class="item" data-title="Configuration">
      <div class="container">
        
  

    

    
      <a class="item" data-title="配置最佳实践" href="/docs/concepts/configuration/overview/"></a>
    
  

  

    

    
      <a class="item" data-title="Managing Compute Resources for Containers" href="/docs/concepts/configuration/manage-compute-resources-container/"></a>
    
  

  

    

    
      <a class="item" data-title="分配 Pod 到 Node 上" href="/docs/concepts/configuration/assign-pod-node/"></a>
    
  

  

    

    
      <a class="item" data-title="Taint 和 Toleration" href="/docs/concepts/configuration/taint-and-toleration/"></a>
    
  

  

    

    
      <a class="item" data-title="Secret" href="/docs/concepts/configuration/secret/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 kubeconfig 文件组织集群访问" href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod 优先级和抢占" href="/docs/concepts/configuration/pod-priority-preemption/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Services, Load Balancing, and Networking">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Service" href="/docs/concepts/services-networking/service/"></a>
    
  

  

    

    
      <a class="item" data-title="DNS Pod 与 Service" href="/docs/concepts/services-networking/dns-pod-service/"></a>
    
  

  

    

    
      <a class="item" data-title="应用连接到 Service" href="/docs/concepts/services-networking/connect-applications-service/"></a>
    
  

  

    

    
      <a class="item" data-title="Ingress resource" href="/docs/concepts/services-networking/ingress/"></a>
    
  

  

    

    
      <a class="item" data-title="Network Policies" href="/docs/concepts/services-networking/network-policies/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 HostAliases 向 Pod /etc/hosts 文件添加条目" href="/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Storage">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Volumes" href="/docs/concepts/storage/volumes/"></a>
    
  

  

    

    
      <a class="item" data-title="持久化卷" href="/docs/concepts/storage/persistent-volumes/"></a>
    
  

  

    

    
      <a class="item" data-title="Storage Classes" href="/docs/concepts/storage/storage-classes/"></a>
    
  

  

    

    
      <a class="item" data-title="Dynamic Volume Provisioning" href="/docs/concepts/storage/dynamic-provisioning/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Cluster Administration">
      <div class="container">
        
  

    

    
      <a class="item" data-title="集群管理概述" href="/docs/concepts/cluster-administration/cluster-administration-overview/"></a>
    
  

  

    

    
      <a class="item" data-title="证书" href="/docs/concepts/cluster-administration/certificates/"></a>
    
  

  

    

    
      <a class="item" data-title="云供应商" href="/docs/concepts/cluster-administration/cloud-providers/"></a>
    
  

  

    

    
      <a class="item" data-title="管理资源" href="/docs/concepts/cluster-administration/manage-deployment/"></a>
    
  

  

    

    
      <a class="item" data-title="" href="/docs/concepts/cluster-administration/networking/"></a>
    
  

  

    

    
      <a class="item" data-title="网络插件" href="/docs/concepts/cluster-administration/network-plugins/"></a>
    
  

  

    

    
      <a class="item" data-title="日志架构" href="/docs/concepts/cluster-administration/logging/"></a>
    
  

  

    

    
      <a class="item" data-title="配置 kubelet 垃圾收集" href="/docs/concepts/cluster-administration/kubelet-garbage-collection/"></a>
    
  

  

    

    
      <a class="item" data-title="联邦（Federation）" href="/docs/concepts/cluster-administration/federation/"></a>
    
  

  

    

    
      <a class="item" data-title="在 Kubernetes 集群中使用 Sysctl" href="/docs/concepts/cluster-administration/sysctl-cluster/"></a>
    
  

  

    

    
  

  

    

    
  

  

    

    
      <a class="item" data-title="Kubernetes 中的代理" href="/docs/concepts/cluster-administration/proxies/"></a>
    
  

  

    

    
      <a class="item" data-title="Controller manager metrics" href="/docs/concepts/cluster-administration/controller-metrics/"></a>
    
  

  

    

    
      <a class="item" data-title="设备插件" href="/docs/concepts/cluster-administration/device-plugins/"></a>
    
  

  
    <div class="item" data-title="Policies">
      <div class="container">
        
  

    

    
      <a class="item" data-title="资源配额" href="/docs/concepts/policy/resource-quotas/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod 安全策略" href="/docs/concepts/policy/pod-security-policy/"></a>
    
  


      </div>
    </div>
  


      </div>
    </div>
  


        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/concepts/containers/images.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>镜像</h1>
        

        
<p>您可以创建您的 Docker 镜像并将其推送到仓库（registry）中，然后再在 Kubernetes pod 中引用它。</p>

<p>容器的 <code class="highlighter-rouge">image</code> 属性支持与 <code class="highlighter-rouge">Docker</code> 命令相同的语法，包括私有仓库和标签（tag）。</p>

<ul id="markdown-toc">
  <li><a href="#更新镜像" id="markdown-toc-更新镜像">更新镜像</a></li>
  <li><a href="#使用私有仓库" id="markdown-toc-使用私有仓库">使用私有仓库</a>    <ul>
      <li><a href="#使用-google-容器仓库" id="markdown-toc-使用-google-容器仓库">使用 Google 容器仓库</a></li>
      <li><a href="#使用-aws-ec2-容器仓库" id="markdown-toc-使用-aws-ec2-容器仓库">使用 AWS EC2 容器仓库</a></li>
      <li><a href="#使用-azure-容器仓库" id="markdown-toc-使用-azure-容器仓库">使用 Azure 容器仓库</a></li>
      <li><a href="#配置节点以对私有仓库进行身份验证" id="markdown-toc-配置节点以对私有仓库进行身份验证">配置节点以对私有仓库进行身份验证</a></li>
      <li><a href="#预拉取镜像" id="markdown-toc-预拉取镜像">预拉取镜像</a></li>
    </ul>
  </li>
  <li><a href="#在-pod-中指定-imagepullsecrets" id="markdown-toc-在-pod-中指定-imagepullsecrets">在 pod 中指定 ImagePullSecrets</a>    <ul>
      <li><a href="#使用-docker-配置创建一个-secret" id="markdown-toc-使用-docker-配置创建一个-secret">使用 Docker 配置创建一个 Secret</a>        <ul>
          <li><a href="#绕过-kubectl-创建-secret" id="markdown-toc-绕过-kubectl-创建-secret">绕过 kubectl 创建 secret</a></li>
        </ul>
      </li>
      <li><a href="#在-pod-上引用-imagepullsecrets" id="markdown-toc-在-pod-上引用-imagepullsecrets">在 pod 上引用 imagePullSecrets</a></li>
      <li><a href="#应用场景" id="markdown-toc-应用场景">应用场景</a></li>
    </ul>
  </li>
</ul>

<h2 id="更新镜像">更新镜像</h2>

<p>默认的拉取策略是 <code class="highlighter-rouge">IfNotPresent</code> ，这将导致 Kubelet 在镜像已经存在的情况下跳过拉取动作。如果您希望始终强制拉取，可以执行下列操作之一：</p>

<ul>
  <li>设置容器的 <code class="highlighter-rouge">imagePullPolicy</code> 为 <code class="highlighter-rouge">Always</code>；</li>
  <li>使用 <code class="highlighter-rouge">:latest</code> 作为镜像的标签去使用；</li>
  <li>开启 <a href="/docs/admin/admission-controllers/#alwayspullimages">AlwaysPullImages</a> 准入控制器。</li>
</ul>

<p>如果您没有指定镜像的标签，它将被假定为 <code class="highlighter-rouge">:latest</code>，相应的镜像拉取策略为 <code class="highlighter-rouge">Always</code>。</p>

<p>注意，您应该避免使用 <code class="highlighter-rouge">:latest</code> 标签，请查看 <a href="/docs/concepts/configuration/overview/#container-images">配置最佳实践</a> 获取更多信息。</p>

<h2 id="使用私有仓库">使用私有仓库</h2>

<p>私有仓库可能需要密钥才能从它们读取镜像。凭证可以通过下面几种方式提供：</p>

<ul>
  <li>使用 Google 容器仓库
    <ul>
      <li>每个集群都可以配置</li>
      <li>在 GCE（Google Compute Engine 谷歌计算引擎）或者 GKE（Google Kubernetes Engine 谷歌 Kubernetes 引擎）上自动配置</li>
      <li>所有 pod 能够读取项目的私有仓库</li>
    </ul>
  </li>
  <li>使用 AWS EC2 容器仓库（ECR）
    <ul>
      <li>使用 IAM 角色和策略去控制对 ECR 存储库的访问</li>
      <li>自动刷新 ECR 登录凭证</li>
    </ul>
  </li>
  <li>
    <p>使用 Azure 容器仓库（ACR）</p>
  </li>
  <li>配置节点以对私有仓库进行身份验证
    <ul>
      <li>所有 pod 能够读取任何配置好的私有仓库</li>
      <li>要求 node 通过集群管理员配置</li>
    </ul>
  </li>
  <li>预先拉取镜像
    <ul>
      <li>所有 pod 能够使用 node 上已经缓存的镜像</li>
      <li>需要能够对所有 node 都能 root 访问才去安装</li>
    </ul>
  </li>
  <li>在 pod 中指定 ImagePullSecrets
    <ul>
      <li>只有提供了自己密钥的 pod 才能访问私有仓库</li>
    </ul>
  </li>
</ul>

<p>下面将详细介绍每个选项。</p>

<h3 id="使用-google-容器仓库">使用 Google 容器仓库</h3>

<p>在 GCE 上运行的时候，Kubernetes 已经原生支持 <a href="https://cloud.google.com/tools/container-registry/">Google 容器仓库（GCR)</a>。如果您的集群运行在 GCE 或者 GKE 上，只需简单的使用完整镜像名（例如 gcr.io/my_project/image:tag）。</p>

<p>集群中的所有 pod 都可以读取此仓库中的镜像。</p>

<p>kubelet 将使用实例的 Google 服务帐户对 GCR 进行身份验证。实例上的服务帐户有一个 <code class="highlighter-rouge">https://www.googleapis.com/auth/devstorage.read_only</code>，所以它可以从项目的 GCR 中拉取，但是不能推送。</p>

<h3 id="使用-aws-ec2-容器仓库">使用 AWS EC2 容器仓库</h3>

<p>当节点是 AWS EC2 实例时，Kubernetes 已经在本地支持 <a href="https://aws.amazon.com/ecr/">AWS EC2 容器仓库</a>。</p>

<p>只需在 pod 定义中使用完整的镜像名称（例如 <code class="highlighter-rouge">ACCOUNT.dkr.ecr.REGION.amazonaws.com/imagename:tag</code>）即可。</p>

<p>集群中所有能够创建 pod 的用户都能够运行使用 ECR 仓库中任何镜像的 pod。</p>

<p>kubelet 将获取并定期刷新 ECR 凭证。它需要以下权限才能做到这一点：</p>

<ul>
  <li><code class="highlighter-rouge">ecr:GetAuthorizationToken</code></li>
  <li><code class="highlighter-rouge">ecr:BatchCheckLayerAvailability</code></li>
  <li><code class="highlighter-rouge">ecr:GetDownloadUrlForLayer</code></li>
  <li><code class="highlighter-rouge">ecr:GetRepositoryPolicy</code></li>
  <li><code class="highlighter-rouge">ecr:DescribeRepositories</code></li>
  <li><code class="highlighter-rouge">ecr:ListImages</code></li>
  <li><code class="highlighter-rouge">ecr:BatchGetImage</code></li>
</ul>

<p>要求：</p>

<ul>
  <li>您必须使用 kubelet <code class="highlighter-rouge">v1.2.0</code> 或更新的版本。（例如 运行 <code class="highlighter-rouge">/usr/bin/kubelet --version=true</code>）。</li>
  <li>如果您的节点位于域 A，而您的仓库位于另一个域 B，则需要 <code class="highlighter-rouge">v1.3.0</code> 或更新的版本。</li>
  <li>ECR 必须在您的域提供</li>
</ul>

<p>故障排查：</p>
<ul>
  <li>验证是否满足上面所有要求。</li>
  <li>在您的工作站上获取 $Region（例如 <code class="highlighter-rouge">us-west-2</code>）凭证。通过 SSH 进入主机，并使用这些凭证手动运行 Docker。能用吗？</li>
  <li>确定 kubelet 是用 <code class="highlighter-rouge">--cloud-provider=aws</code> 运行的。</li>
  <li>查看 kubelet 日志（例如 <code class="highlighter-rouge">journalctl -u kubelet</code>）中类似下面这样的日志行：
    <ul>
      <li><code class="highlighter-rouge">plugins.go:56] Registering credential provider: aws-ecr-key</code></li>
      <li><code class="highlighter-rouge">provider.go:91] Refreshing cache for provider: *aws_credentials.ecrProvider</code></li>
    </ul>
  </li>
</ul>

<h3 id="使用-azure-容器仓库">使用 Azure 容器仓库</h3>

<p>使用 <a href="https://azure.microsoft.com/en-us/services/container-registry/">Azure 容器仓库</a> 的时候，您可以使用管理用户或服务主体进行身份验证。任何情况下，认证都是通过标准的 Docker 认证完成的。这些指令假定为 <a href="https://github.com/azure/azure-cli">azure-cli</a> 命令行工具。</p>

<p>您首先需要创建一个仓库并生成凭证，有关这方面的完整文档可以在 <a href="https://docs.microsoft.com/en-us/azure/container-registry/container-registry-get-started-azure-cli">Azure 容器仓库文档</a> 中找到。</p>

<p>一旦完成容器仓库的创建，您就可以使用下面这些凭证去登录：</p>

<ul>
  <li><code class="highlighter-rouge">DOCKER_USER</code> ：服务主体，或者管理用户</li>
  <li><code class="highlighter-rouge">DOCKER_PASSWORD</code>：服务主体密码，或者管理用户密码</li>
  <li><code class="highlighter-rouge">DOCKER_REGISTRY_SERVER</code>：<code class="highlighter-rouge">${某个仓库名}.azurecr.io</code></li>
  <li><code class="highlighter-rouge">DOCKER_EMAIL</code>：<code class="highlighter-rouge">${某个 email 地址}</code></li>
</ul>

<p>填好了这些变量之后，您就可以 <a href="/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod">配置一个 Kubernetes Secret 并使用它部署一个 Pod</a>。</p>

<h3 id="配置节点以对私有仓库进行身份验证">配置节点以对私有仓库进行身份验证</h3>

<p><strong>注：</strong> 如果您在 GKE 运行，那么每个节点上都会有一个 <code class="highlighter-rouge">.dockercfg</code>，它具有 Google 容器仓库的凭证。您不能使用这种方法。</p>

<p><strong>注：</strong> 如果您在 AWS EC2 上运行，并且正在使用 ECR，每个节点上的 kubelet 将管理和更新 ECR 登录凭证。您不能使用这种方法。</p>

<p><strong>注：</strong> 如果您可以控制节点配置，则此方法非常适合。它无法可靠地在 GCE 和任何其他云服务提供商上进行自动节点替换。</p>

<p>Docker 将私有仓库的密钥存储在在文件 <code class="highlighter-rouge">$HOME/.dockercfg</code> 或者 <code class="highlighter-rouge">$HOME/.docker/config.json</code> 中。如果您把这个文件放在 kubelet 所在节点的 <code class="highlighter-rouge">root</code> 用户的 <code class="highlighter-rouge">$HOME</code> 中，那么 docker 就会使用它。</p>

<p>下面是配置节点使用私有仓库的推荐步骤。在这个示例中，在您的电脑上运行：</p>

<ol>
  <li>对于要使用的每一组凭证，请运行 <code class="highlighter-rouge">docker login [server]</code>。这将更新 <code class="highlighter-rouge">$HOME/.docker/config.json</code>。</li>
  <li>在编辑器中查看 <code class="highlighter-rouge">$HOME/.docker/config.json</code>，确保它包含了您想要使用的凭证。</li>
  <li>获取 node 列表，例如：
    <ul>
      <li>如果想要获取名字：<code class="highlighter-rouge">nodes=$(kubectl get nodes -o jsonpath='{range.items[*].metadata}{.name} {end}')</code></li>
      <li>如果想要获取IP：<code class="highlighter-rouge">nodes=$(kubectl get nodes -o jsonpath='{range .items[*].status.addresses[?(@.type=="ExternalIP")]}{.address} {end}')</code></li>
    </ul>
  </li>
  <li>复制您本地的 <code class="highlighter-rouge">.docker/config.json</code> 文件到所有 node 的 root 用户 home 目录下。
    <ul>
      <li>例如：<code class="highlighter-rouge">for n in $nodes; do scp ~/.docker/config.json root@$n:/root/.docker/config.json; done</code></li>
    </ul>
  </li>
</ol>

<p>通过创建一个使用私有镜像的 pod 进行验证，例如：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">$ cat &lt;&lt;EOF &gt; /tmp/private-image-test-1.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">private-image-test-1</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">uses-private-image</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">$PRIVATE_IMAGE_NAME</span>
      <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">Always</span>
      <span class="na">command</span><span class="pi">:</span> <span class="pi">[</span> <span class="s2">"</span><span class="s">echo"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">SUCCESS"</span> <span class="pi">]</span>
<span class="s">EOF</span>
<span class="s">$ kubectl create -f /tmp/private-image-test-1.yaml</span>
<span class="s">pod "private-image-test-1" created</span>
<span class="s">$</span>
</code></pre></div></div>

<p>如果一切正常，那么，过了一会儿，您应该看到：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl logs private-image-test-1
SUCCESS
</code></pre></div></div>

<p>如果失败，您将看到：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl describe pods/private-image-test-1 | <span class="nb">grep</span> <span class="s2">"Failed"</span>
  Fri, 26 Jun 2015 15:36:13 <span class="nt">-0700</span>    Fri, 26 Jun 2015 15:39:13 <span class="nt">-0700</span>    19    <span class="o">{</span>kubelet node-i2hq<span class="o">}</span>    spec.containers<span class="o">{</span>uses-private-image<span class="o">}</span>    failed        Failed to pull image <span class="s2">"user/privaterepo:v1"</span>: Error: image user/privaterepo:v1 not found
</code></pre></div></div>

<p>您必须确保集群中的所有节点都具有相同的 <code class="highlighter-rouge">.docker/config.json</code>。否则，pod 将能在一些节点上运行，而在另一些节点上运行失败。例如，如果使用节点自动伸缩，那么每个实例模板都需要包含 <code class="highlighter-rouge">.docker/config.json</code>，或者挂载包含它的驱动器。</p>

<p>一旦私有仓库被添加到 <code class="highlighter-rouge">.docker/config.json</code>，所有的 pod 都可以读取私有仓库中的任何镜像。</p>

<p><strong>这在 6 月 26 日用 Kubernetes 的 0.19.3 版本进行了测试，它也应该适用于 quay.io 这样的私有仓库，但还没有经过测试。</strong></p>

<h3 id="预拉取镜像">预拉取镜像</h3>

<p><strong>注：</strong> 如果您在 GKE 上运行，那么每个节点上都会有一个 <code class="highlighter-rouge">.dockercfg</code>，它包含 Google 容器仓库的凭证。您不能使用这种方法。</p>

<p><strong>注：</strong> 如果您可以控制节点配置，则此方法是合适的。它不会可靠地在 GCE 和任何其他云服务提供商上进行自动节点替换。</p>

<p>默认情况下，kubelet 将尝试从指定的仓库中拉取每个镜像。但是，如果容器的 <code class="highlighter-rouge">imagePullPolicy</code> 属性设置为 <code class="highlighter-rouge">IfNotPresent</code> 或者 <code class="highlighter-rouge">Never</code>，则使用本地镜像（分别为优先使用本地镜像或者只能使用本地镜像）。</p>

<p>如果您希望依赖于预拉取镜像作为仓库身份验证的替代，则必须确保集群中的所有节点都具有相同的预拉取镜像。</p>

<p>这可以用于预加载某些镜像以提高速度，或者作为对私有仓库进行身份验证的替代方法。</p>

<p>所有 pod 都有读取预拉取镜像的权限。</p>

<h2 id="在-pod-中指定-imagepullsecrets">在 pod 中指定 ImagePullSecrets</h2>

<p><strong>注：</strong> 这种方法目前是推荐用于 GKE、GCE 和任何自动创建节点的云服务提供商的方法。</p>

<p>Kubernetes 支持在 pod 上指定仓库密钥。</p>

<h4 id="使用-docker-配置创建一个-secret">使用 Docker 配置创建一个 Secret</h4>

<p>运行以下命令，将大写值替换为适当的值：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl create secret docker-registry myregistrykey <span class="nt">--docker-server</span><span class="o">=</span>DOCKER_REGISTRY_SERVER <span class="nt">--docker-username</span><span class="o">=</span>DOCKER_USER <span class="nt">--docker-password</span><span class="o">=</span>DOCKER_PASSWORD <span class="nt">--docker-email</span><span class="o">=</span>DOCKER_EMAIL
secret <span class="s2">"myregistrykey"</span> created.
</code></pre></div></div>

<p>如果需要访问多个仓库，则可以为每个仓库创建一个 secret。Kubelet 在为您的 Pod 拉取镜像时，会将所有 <code class="highlighter-rouge">imagePullSecrets</code> 合并成一个虚拟的 <code class="highlighter-rouge">.docker/config.json</code>。</p>

<p>Pod 只能引用它们自己命名空间中的镜像拉取 secret，因此，每个命名空间都需要完成一次此过程。</p>

<h5 id="绕过-kubectl-创建-secret">绕过 kubectl 创建 secret</h5>

<p>如果出于某种原因，您需要单个 <code class="highlighter-rouge">.docker/config.json</code> 中的多个项，或者需要上面命令没有提供的控制，那么您可以 <a href="/docs/user-guide/secrets/#creating-a-secret-manually">使用 json 或者 yaml 创建 secret</a>。</p>

<p>请确保：</p>

<ul>
  <li>将数据项的名称设置为 <code class="highlighter-rouge">.dockerconfigjson</code></li>
  <li>使用 base64 对 docker 文件进行编码，粘贴生成的字符串，将其作为字段 <code class="highlighter-rouge">data[".dockerconfigjson"]</code> 的值</li>
  <li>将 <code class="highlighter-rouge">type</code> 设置为 <code class="highlighter-rouge">kubernetes.io/dockerconfigjson</code></li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myregistrykey</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">awesomeapps</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="s">.dockerconfigjson</span><span class="pi">:</span> <span class="s">UmVhbGx5IHJlYWxseSByZWVlZWVlZWVlZWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGx5eXl5eXl5eXl5eXl5eXl5eXl5eSBsbGxsbGxsbGxsbGxsbG9vb29vb29vb29vb29vb29vb29vb29vb29vb25ubm5ubm5ubm5ubm5ubm5ubm5ubm5ubmdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2cgYXV0aCBrZXlzCg==</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">kubernetes.io/dockerconfigjson</span>
</code></pre></div></div>

<p>如果您收到错误消息 <code class="highlighter-rouge">error: no objects passed to create</code>，这可能意味着 base64 编码的字符串无效。如果您收到的错误类似 <code class="highlighter-rouge">Secret "myregistrykey" is invalid: data[.dockerconfigjson]: invalid value ...</code>，这意味着数据已成功地编码为 un-base64，但无法解析为一个 <code class="highlighter-rouge">.docker/config.json</code> 文件。</p>

<h4 id="在-pod-上引用-imagepullsecrets">在 pod 上引用 imagePullSecrets</h4>

<p>现在，您可以通过在 pod 定义中添加一个 <code class="highlighter-rouge">imagePullSecrets</code> 部分来创建引用 secret 的 pod。</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">foo</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">awesomeapps</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">foo</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">janedoe/awesomeapp:v1</span>
  <span class="na">imagePullSecrets</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myregistrykey</span>
</code></pre></div></div>

<p>这需要对每个使用私有仓库的 pod 进行操作。</p>

<p>但是，通过在 <a href="/docs/user-guide/service-accounts">serviceAccount</a> 资源中设置 imagePullSecrets，可以自动设置此字段。</p>

<p>您可以将其与每个节点的 <code class="highlighter-rouge">.docker/config.json</code> 结合使用。凭证将会合并。这一方法适用于 GKE。</p>

<h3 id="应用场景">应用场景</h3>

<p>有许多配置私有仓库的解决方案。以下是一些常见的用例和建议的解决方案。</p>

<ol>
  <li>集群只运行非专有（例如，开放源码）镜像。不需要隐藏镜像。
    <ul>
      <li>在 Docker hub 上使用公共镜像
        <ul>
          <li>不需要配置。</li>
          <li>在 GCE 或 GKE 上，自动使用本地镜像来提高速度和可用性。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>集群运行一些私有镜像，这些镜像应该对公司以外用户进行隐藏，但对所有集群用户都是可见的。
    <ul>
      <li>使用托管的 <a href="https://docs.docker.com/registry/">Docker 仓库</a>。
        <ul>
          <li>它可能托管在 <a href="https://hub.docker.com/account/signup/">Docker Hub</a> 上，或其它地方。</li>
          <li>像上面描述的那样在每个节点上手动配置 .docker/config.json。</li>
        </ul>
      </li>
      <li>或者，在防火墙后面运行内部私有仓库，并打开读取访问权限。
        <ul>
          <li>不需要 Kubernetes 配置。</li>
        </ul>
      </li>
      <li>或者，在 GCE 或 GKE 上，使用项目的 Google 容器仓库。
        <ul>
          <li>与手动节点配置相比，集群自动伸缩会更好地工作。</li>
        </ul>
      </li>
      <li>或者，在更改节点配置不方便的集群上，使用 <code class="highlighter-rouge">imagePullSecrets</code>。</li>
    </ul>
  </li>
  <li>拥有专有镜像的集群，其中一些需要更严格的访问控制。
    <ul>
      <li>确保 <a href="/docs/admin/admission-controllers/#alwayspullimages">AlwaysPullImages 准入控制器</a> 打开。否则，所有 pod 都可能访问所有的镜像。</li>
      <li>将敏感数据移动到 “Secret” 资源中，而不是将其打包到镜像中。</li>
    </ul>
  </li>
  <li>多租户集群，每个租户都需要自己的私有仓库。
    <ul>
      <li>确保 <a href="/docs/admin/admission-controllers/#alwayspullimages">AlwaysPullImages 准入控制器</a> 打开。否则，所有 pod 都可能访问所有的镜像。</li>
      <li>运行需要授权的私有仓库。</li>
      <li>为每个租户生成仓库凭证，将其转换为 secret，并将 secret 填充到每个租户命名空间。</li>
      <li>租户将该 secret 添加到每个命名空间的 imagePullSecrets 中。</li>
    </ul>
  </li>
</ol>



        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/concepts/containers/images.md?pixel" alt="Analytics" /></a></p>
        
        
        <script type="text/javascript">
            PDRTJS_settings_8345992 = {
                "id" : "8345992",
                "unique_id" : "/docs/concepts/containers/images/",
                "title" : "镜像",
                "permalink" : "https://kubernetes.io/docs/concepts/containers/images/"
            };
            (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
        <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?title=Issue%20with%20' +
        'k8s.io'+window.location.pathname)" class="button issue">Create an Issue</a>
        
        
          <a href="/editdocs#docs/concepts/containers/images.md" class="button issue">Edit this Page</a>
        
    
    </div>
</section>

<footer>
    <main class="light-text">
        <nav>
            <a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a>
            <a href="/docs/home/">Documentation</a>
            <a href="http://blog.kubernetes.io/">Blog</a>
            <a href="/partners/">Partners</a>
            <a href="/community/">Community</a>
            <a href="/case-studies/">Case Studies</a>
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                <a href="/docs/setup/pick-right-solution/" class="button">Get Kubernetes</a>
                <a href="https://github.com/kubernetes/kubernetes" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2018 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2018 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>

<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
